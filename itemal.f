C>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
C            BEGINNING OF DELETION FOR CONVERSION TO IBM FORTRAN       >
C         $SET LIST LINEINFO RESET FREE                                >
C         FILE  5(KIND=READER)                                         >
C         FILE  6(KIND=PRINTER,MAXRECSIZE=22)                          >
C         FILE  7(KIND=PUNCH)                                          >
C>>>>>>>>>   END OF DELETION FOR CONVERSION TO IBM FORTRAN   >>>>>>>>>>>
 
C     FIFTED 11/10/69 -- FIFT * VERSION 2.12 *
C     ITEM ANALYSIS PROGRAM
C     EXAMINATION SERVICES
C     APRIL. 1966   WALTER DICK
C     REVISED FORTRAN IV VERSION    31 OCT 67    R. KOHR
C    REVISED  26JAN68
C    REVISED  31JAN68     CHANGED STANDARD FORMAT
C    REVISED  05FEB68
C REVISED 8FEB68 CORRECTIONS  IN AVG. DIFFICULTY COMPUTATIONS
C    REVISED  24FEB68   ALLOWS 3-DIGIT SCORE FOR EACH OPT AVG
C    REVISED  12JAN70 -- ADDED SUBROUTINE CONTRL -- R. KOHR
C    REVISED   9AUG85 -- CONVERTED TO IBM VSFORTRAN -- R.S.SACHER
      CHARACTER COURS*10, INST*10, FMT*72
      DIMENSION FCOUNT(160),FMNCO(160),QCOUNT(160),FITC(160),FITIC(160),
     1 Q(160),DIFI(160),FMNIC(160),Y(160),CHEK(9),FKSUM(160,10),
     2 ICOUNT(160),ITC(160),ITIC(160),IRESP(160),KSUM(160,10)
      COMMON BIS(160),T(160),PBIS(160),GITEMN,VAR,SBIS,SDI,FITN,FITEMN,
     1 FMEAN,FVAR,SER,SDEV,TOT(160,10),CMEAN(160,10),PROP(160,10),
     2 CNTKEY(9),PROSUM(9),CNTCHO(9),ITAB(160,10,5),JTOT(160,10)
      COMMON /B2/  IDIST(160,10),
     3               KOUNT(10),IBI(160),IDI(160),KTOT(160),KORAN(160),
     4 IDO,IDTW,IDTH,IDFO,IDFI,IDVP,IDG,IDP,IDVG,IDVVG,IDEX,KTC,KDA,
     5 KDE,KDI,ITN,ITEMN,KODE,ICHO,IDIG,NCOPY,NNXYZ,JCHO,NEWRUN,COURS
     6  ,INST,NOUNT,FMT
      DATA CHEK/0.2,0.2,0.1,0.07,0.05,4*0.04/
      DATA IPRINT/6/,IPUNCH/7/,IREAD/5/
C
      open(unit=6, form='print')
C
   10 NNXYZ=0
      NEWRUN=0
      GITEMN=0.0
      VAR=0.0
      SBIS=0.0
      SDI=0.0
      IDO=0
      IDTW=0
      IDTH=0
      IDFO=0
      IDFI=0
      IDVP=0
      IDG=0
      IDP=0
      IDVG=0
      IDVVG=0
      IDEX=0
      NOUNT =5
      DO 20 J=1,9
      CNTKEY(J)=0.0
      PROSUM(J)=0.0
   20 CNTCHO(J)=0.0
C
 40   CALL CONTRL
C
      FITN=ITN
      FITEMN=ITEMN
      GITEMN=GITEMN+FITEMN
      ISUMSQ=0
      ISUM=0
      DO 110 I=1,160
      DO 110 J=1,10
      DO 100 L=1,5
  100 ITAB(I,J,L)=0
      KSUM(I,J)=0
      JTOT(I,J)=0
  110 IDIST(I,J)=0
      DO 120 L=1,5
  120 KOUNT(L)=0
      DO 130 I=1,160
      ICOUNT(I)=0
      IBI(I)=0
      IDI(I)=0
      ITC(I)=0
      FMNCO(I)=0.0
      FMNIC(I)=0.0
      ITIC(I)=0
      KTOT(I)=0
  130 CONTINUE
  140 JCHO=ICHO+1
      L=1
C
C
C  READ INPUT DATA
 150  READ (NOUNT,FMT=FMT) ICRIT,(IRESP(I),I=1,ITEMN)
  180 IF (ICRIT.GE.0) GO TO 190
      L=L+1
      IF (L.GT.5) GO TO 310
      GO TO 150
  190 KOUNT(L)=KOUNT(L)+1
      ISUM=ISUM+ICRIT
      ISUMSQ=ISUMSQ+ICRIT**2
      GO TO (230,200),IDIG
  200 DO 220 I=1,ITEMN
      IF (IRESP(I).NE.0) GO TO 210
      IRESP(I)=0
      GO TO 220
  210 IRESP(I)=ICHO+1-IRESP(I)
  220 CONTINUE
  230 DO 300 I=1,ITEMN
      IF (KORAN(I).NE.IRESP(I)) GO TO 240
      ICOUNT(I)=ICOUNT(I)+1
      ITC(I)=ITC(I)+ICRIT
      GO TO 250
  240 ITIC(I)=ITIC(I)+ICRIT
  250 IF (IRESP(I).LT.0) GO TO 260
      IF (IRESP(I).GT.ICHO) GO TO 280
      J=IRESP(I)+1
      ITAB(I,J,L)=ITAB(I,J,L)+1
      JTOT(I,J)=JTOT(I,J)+1
      KSUM(I,J)=KSUM(I,J)+ICRIT
      GO TO 300
  260 WRITE (IPRINT,270) I,L
  270 FORMAT (1H0,24HA RESPONSE FOR QUESTION ,I2,1X,10HFOR GROUP ,I1,1X,
     116HREAD AS NEGATIVE)
      GO TO 300
  280 WRITE (IPRINT,290) I,L,ICHO
  290 FORMAT (1H0,24HA RESPONSE FOR QUESTION ,I2,1X,10HFOR GROUP ,I1,1X,
     121HREAD AS GREATER THAN ,I1)
  300 CONTINUE
      GO TO 150
  310 DO 400 I=1,ITEMN
      DO 330 J=1,JCHO
      KTOT(I)=KTOT(I)+JTOT(I,J)
      TOT(I,J)=JTOT(I,J)
      FKSUM(I,J)=KSUM(I,J)
      IF (TOT(I,J).GT.0) GO TO 320
      CMEAN(I,J)=0.0
      GO TO 330
  320 CMEAN(I,J)=FKSUM(I,J)/TOT(I,J)
  330 PROP(I,J)=TOT(I,J)/FITN
      FCOUNT(I)=ICOUNT(I)
      DIFI(I)=FCOUNT(I)/FITN
      IF (DIFI(I).GT.0.19) GO TO 340
      IDO=IDO+1
      GO TO 400
  340 IF (DIFI(I).GT.0.39) GO TO 350
      IDTW=IDTW+1
      GO TO 400
  350 IF (DIFI(I).GT.0.59) GO TO 360
      IDTH=IDTH+1
      GO TO 400
  360 IF (DIFI(I).GT.0.79) GO TO 370
      IDFO=IDFO+1
      GO TO 400
  370 IF (DIFI(I).LE.1.0) GO TO 390
      WRITE (IPRINT,380) I
 380  FORMAT ('0DIFFICULTY OF ITEM', I2,'  IS GREATER THAN ONE OR LESS T
     1HAN ZERO.' )
      GO TO 400
  390 IDFI=IDFI+1
  400 CONTINUE
      IF (KODE.LT.1) GO TO 460
      DO 450 I=1,ITEMN
      IF (DIFI(I).LE.0.40) GO TO 410
      IF (DIFI(I).GT.0.61) GO TO 410
      IDI(I)=5
      GO TO 450
  410 IF (DIFI(I).LE.0.30) GO TO 420
      IF (DIFI(I).GT.0.71) GO TO 420
      IDI(I)=4
      GO TO 450
  420 IF (DIFI(I).LE.0.20) GO TO 430
      IF (DIFI(I).GT.0.81) GO TO 430
      IDI(I)=3
      GO TO 450
  430 IF (DIFI(I).LE.0.10) GO TO 440
      IF (DIFI(I).GT.0.91) GO TO 440
      IDI(I)=2
      GO TO 450
  440 IDI(I)=1
  450 CONTINUE
  460 FSUM=ISUM
      FSUMSQ=ISUMSQ
      FMEAN=FSUM/FITN
      FVAR=(FITN*FSUMSQ-FSUM**2)/(FITN*(FITN-1.0))
      SER=1.0/(SQRT(FITN-1.0))
      SDEV=SQRT(FVAR)
C
      DO 540 I=1,ITEMN
      DO 480 J=2,JCHO
      IDIST(I,J)=1
      IF (PROP(I,J).LT.CHEK(ICHO)) IDIST(I,J)=2
  480 CONTINUE
      KEY=KORAN(I)+1
      IDIST(I,KEY)=1
      IF (PROP(I,KEY).LT.0.20 .OR. PROP(I,KEY).GT.0.80) IDIST(I,KEY)=2
      DO 530 J=2,JCHO
      IF (IDIST(I,J).EQ.2) GO TO 530
      IF (CMEAN(I,J).LE.CMEAN(I,KEY)) GO TO 520
      IDIST(I,J)=2
      GO TO 530
  520 IF (CMEAN(I,KEY).LT.FMEAN) IDIST(I,J)=2
  530 CONTINUE
  540 CONTINUE
C
      DO 700 I=1,ITEMN
      IF (DIFI(I).LT.0) GO TO 570
      IF (DIFI(I).EQ.0) GO TO 550
      IF (DIFI(I).NE.1.0) GO TO 580
      GO TO 560
  550 FMNCO(I)=0.0
      FMNIC(I)=FMEAN
      GO TO 570
  560 FMNCO(I)=FMEAN
      FMNIC(I)=0.0
  570 BIS(I)=0.0
      PBIS(I)=0.0
      T(I)=0.0
      GO TO 630
  580 IF (DIFI(I).LT.0.5) GO TO 590
      IF (DIFI(I).GT.0.5) GO TO 600
      Y(I)=0.39894
      GO TO 620
  590 IF (DIFI(I).LE.0) GO TO 620
      AREA=1.0-DIFI(I)
      GO TO 610
  600 IF (DIFI(I).GT.1.0) GO TO 620
      AREA=DIFI(I)
  610 ETA=SQRT(ALOG(1.0/AREA**2))
      ABCISA=ETA-((2.30753+0.27061*ETA)/(1.0+0.99229*ETA+0.04481*ETA**2)
     1)
      Y(I)=0.3989422*(1.0/(2.7182818**(ABCISA**2/2.0)))
  620 FITC(I)=ITC(I)
      FITIC(I)=ITIC(I)
      FMNCO(I)=FITC(I)/FCOUNT(I)
      QCOUNT(I)=FITN-FCOUNT(I)
      FMNIC(I)=FITIC(I)/QCOUNT(I)
      Q(I)=1.0-DIFI(I)
      VAR=VAR+(DIFI(I)*Q(I))
      IF (SDEV.EQ.0.0) GO TO 632
      BIS(I)=((FMNCO(I)-FMNIC(I))/SDEV)*DIFI(I)*Q(I)/Y(I)
      PBIS(I)=BIS(I)*(Y(I)/SQRT(DIFI(I)*Q(I)))
      T(I)=PBIS(I)*SQRT((FITN-2.0)/(1.0-PBIS(I)**2))
  630 IF (BIS(I).GT.0.11) GO TO 640
      IDVP=IDVP+1
      IBI(I)=1
      GO TO 690
C
 632  BIS(I) =0.0
      PBIS(I) =0.0
      T(I) =0.0
      GO TO 630
C
  640 IF (BIS(I).GT.0.31) GO TO 650
      IDP=IDP+1
      IBI(I)=2
      GO TO 690
  650 IF (BIS(I).GT.0.51) GO TO 660
      IDG=IDG+1
      IBI(I)=3
      GO TO 690
  660 IF (BIS(I).GT.0.71) GO TO 670
      IDVG=IDVG+1
      IBI(I)=4
      GO TO 690
  670 IF (BIS(I).GT.0.91) GO TO 680
      IDVVG=IDVVG+1
      IBI(I)=5
      GO TO 690
  680 IDEX=IDEX+1
      IBI(I)=5
  690 SDI=SDI+DIFI(I)
      SBIS=SBIS+BIS(I)
  700 CONTINUE
      CALL PRINT
      IF (NEWRUN.EQ.1) GO TO 10
      GO TO 40
      END
      SUBROUTINE PRINT
C     FIFTED 11/10/69 -- FIFT * VERSION 2.12 *
C
C      PRINT SUBROUTINE FOR ITEMA - ITEM ANALYSIS
C
      CHARACTER COURS*10, INST*10, FMT*72
      CHARACTER ANS(10)*1, DISTR(2)*1, LETTER(5)*1
      DIMENSION PCTKEY(9),PCTCHO(9),AVDIFF(9)
      DIMENSION IRESP(160)
      COMMON BIS(160),T(160),PBIS(160),GITEMN,VAR,SBIS,SDI,FITN,FITEMN,
     1 FMEAN,FVAR,SER,SDEV,TOT(160,10),CMEAN(160,10),PROP(160,10),
     2 CNTKEY(9),PROSUM(9),CNTCHO(9),ITAB(160,10,5),JTOT(160,10)
      COMMON /B2/  IDIST(160,10),
     3               KOUNT(10),IBI(160),IDI(160),KTOT(160),KORAN(160),
     4 IDO,IDTW,IDTH,IDFO,IDFI,IDVP,IDG,IDP,IDVG,IDVVG,IDEX,KTC,KDA,
     5 KDE,KDI,ITN,ITEMN,KODE,ICHO,IDIG,NCOPY,NNXYZ,JCHO,NEWRUN,COURS
     6  ,INST,NOUNT,FMT
      DATA ANS/' ','A','B','C','D','E','F','G','H','I'/, DISTR/' ','?'/
      DATA LETTER/'E','D','C','B','A'/
      DATA IPRINT/6/,IPUNCH/7/,IREAD/5/
C
C  THIS DO LOOP IS CONCERNED WITH PRINTING THE INFORMATION ON EACH
C  TEST ITEM (I.E., FREQUENCY TABLE, STAT. DATA, ITEM EVALUATION)
C
      DO 350 JAM=1,NCOPY
      L1=0
      L2=1
CCCCC JUP=NNXYZ*350          Deleted 12/5/85  R.S.Sacher
      JUP=NNXYZ
CCCCC WRITE (IPRINT,10) COURS,INST ,KTC,KDA,KDE,KDI,ITN
CCC10 FORMAT ('1',25X,A10,20X,A10 /'0',10X,'TEST CODE',I6,8X,'DATE',I4,
CCCC 1 '/',I2,'/',I2,8X,'NUMBER OF STUDENTS =',I5 ////)
       WRITE(6,10)
   10  FORMAT('1')
      DO 350 I=1,ITEMN
      JUP=JUP+1
      KOR=KORAN(I)+1
      KAN=KORAN(I)
      GO TO (40,30),IDIG
   30 KAN=JCHO-KAN
   40 L1=L1+1
      L2=L2+1
      IF (I.LE.2) GO TO 80
      IF (ICHO.LE.5) GO TO 50
      IF (L1.GT.2) GO TO 60
      GO TO 80
   50 IF (L2.LE.3) GO TO 80
   60 WRITE (IPRINT,70) JUP
   70 FORMAT ('1',15X,'ITEM NUMBER',I4,8X,'CORRECT ANSWER AND ITEM DIFFI
     1CULTY INDEX ARE IDENTIFIED BY  * ' /)
      L1=1
      L2=1
      GO TO 100
   80 WRITE (IPRINT,90) JUP
   90 FORMAT (' ',15X,'ITEM NUMBER',I4,8X,'CORRECT ANSWER AND ITEM DIFFI
     1CULTY INDEX ARE IDENTIFIED BY  * ' /)
  100 WRITE (IPRINT,110)
C       Format 110 changed 10/8/85 by R. Sacher to fix error
  110 FORMAT (   '   OPTIONS',5X,'1ST',4X,'2ND',4X,'3RD',4X,'4TH',4X,'5T
     1H',3X,'RESPONSE',4X,'PROPORTION',4X,'MEAN',6X,'OPTIONS'/
     2            14X,5HGROUP,2X,5HGROUP,2X,5HGROUP,2X,5HGROUP,2X,5HGROU
     1P,4X,5HTOTAL,6X,8HCHOOSING,5X,5HSCORE,3X,12HQUESTIONABLE)
      J=1
      IF (ANS(KOR).EQ.ANS(J)) GO TO 150
  130 WRITE (IPRINT,140) (ITAB(I,J,L),L=1,5),JTOT(I,J),PROP(I,J),CMEAN(I
     1,J)
  140 FORMAT (1H ,3X,4HOMIT,5X,I3,4X,I3,4X,I3,4X,I3,4X,I3,5X,I4,9X,F6.3,
     16X,F6.2)
      GO TO 170
  150 WRITE (IPRINT,160) (ITAB(I,J,L),L=1,5),JTOT(I,J),PROP(I,J),CMEAN(I
     1,J)
  160 FORMAT (3X,'*',4HOMIT,5X,I3,4X,I3,4X,I3,4X,I3,4X,I3,5X,I4,8X,'*',F
     16.3,6X,F6.2)
C
  170 JK=JCHO
      DO 250 J=2,JCHO
      GO TO (190,180),IDIG
  180 JK=JK-1
      K=JK
      GO TO 200
  190 K=J-1
  200 IDIS=IDIST(I,J)
      IF (ANS(KOR).EQ.ANS(J)) GO TO 230
  210 WRITE (IPRINT,220) ANS(J),K,(ITAB(I,J,L),L=1,5),JTOT(I,J),PROP(I,J
     1),CMEAN(I,J),DISTR(IDIS)
  220 FORMAT (' ',2X,A1,' OR ',I1,4X,I3,4(4X,I3),5X,I4,9X,F6.3,6X,F6.2,8
     1X,A1)
      GO TO 250
  230 WRITE (IPRINT,240) ANS(J),K,(ITAB(I,J,L),L=1,5),JTOT(I,J),PROP(I,J
     1),CMEAN(I,J),DISTR(IDIS)
  240 FORMAT (2X,'*',A1,' OR ',I1,4X,I3,4(4X,I3),5X,I4,8X,'*',F6.3,6X,F6
     1.2,8X,A1)
  250 CONTINUE
C
      WRITE (IPRINT,260) (KOUNT(L),L=1,5),KTOT(I)
  260 FORMAT (1H0,2X,5HTOTAL,5X,I3,4X,I3,4X,I3,4X,I3,4X,I3,5X,I4)
      WRITE (IPRINT,270) BIS(I)
  270 FORMAT (1H0,'BISERIAL CORRELATION BETWEEN ITEM SCORE AND TOTAL ',
     1'SCORE ON TEST = ',F6.3)
      WRITE (IPRINT,280) PBIS(I),T(I)
  280 FORMAT (1H ,29HPOINT-BISERIAL CORRELATION = ,F6.3,
     &  14X,4HT = ,F6.3///)
C
      IF (KODE.GT.0) GO TO 300
      WRITE (IPRINT,290)
  290 FORMAT (1H ,///)
      GO TO 350
  300 JUNK=IDI(I)
      KUNK=IBI(I)
      IF (IBI(I).GT.1) GO TO 310
      MUNK=1
      GO TO 330
  310 IF ((IBI(I)+IDI(I)).LT.10) GO TO 320
      MUNK=5
      GO TO 330
  320 MUNK=(IDI(I)+IBI(I)+1)/2
  330 CONTINUE
C       330 WRITE (IPRINT,340) LETTER(JUNK),LETTER(KUNK),LETTER(MUNK)
C 340 FORMAT (' ','EVALUATION OF',4X,'(1) ITEM DIFFICULTY= ',A1,4X,'(2
C    1ITEM DISCRIMINATION= ',A1,4X,'(3) TOTAL ITEM EVALUATION= ',A1///)
  350 CONTINUE
C
CCCCC NNXYZ=NNXYZ+1       Deleted by R.S.Sacher 12/5/85
      NNXYZ=NNXYZ+ITEMN
      DO 360 I=1,ITEMN
      KEY=KORAN(I)
      KY=KEY+1
      CNTKEY(KEY)=CNTKEY(KEY)+1.0
      PROSUM(KEY)=PROSUM(KEY)+PROP(I,KY)
      DO 360 J=2,JCHO
      JJ=J-1
  360 CNTCHO(JJ)=CNTCHO(JJ)+TOT(I,J)
      KTN=ITN
      KCHO=ICHO
      MCOPY=NCOPY
C  READ CONTROL CARD ---  IF CARD IS BLANK IT SERVES AS A TRANSFER
C  CARD WHICH INDICATES THE END OF A DATA SET OF NITEM  ITEMS.  CONTROL
C  IS PASSED ON TO ST-380 FOR SUMMARY STATISTICS AND PRINTOUT SECTION.
C    IF THE CARD IS NOT BLANK IT IS A NEW PARAMETER CARD INDICATING
C  THAT THE JOB HAS MORE THAN 160 ITEMS AND THE REMAINING ITEMS AND
C  CORRESPONDING CORRECT ANSWERS WILL BE READ NEXT.  CONTROL IS PASSED
C  BACK TO THE MAIN PROGRAM FOR CONTINUED PROCESSING.
      READ (IREAD,370) KTC,COURS,INST,KDA,KDE,KDI,ITN,ITEMN,KODE,ICHO,ID
     1IG,   NCOPY
 370  FORMAT (I4,2A10,5X,3I2,1X,I4,2X,I3,3(4X,I1), 1X,3X,I1 )
      IF (ITEMN.LE.0) GO TO 380
      NEWRUN= 2
      RETURN
C
 378  REL =0.0
      SEMEAS =0.0
      GO TO 382
C
C
  380 FMEDI=SDI/GITEMN
      FMEBIS=SBIS/GITEMN
      CORI=FMEBIS**2
      IF (FVAR.EQ.0.0) GO TO 378
      REL=(GITEMN/(GITEMN-1.0))*((FVAR-VAR)/FVAR)
      SEMEAS=SDEV*SQRT(1.0-REL)
 382  DO 390 KEY=1,KCHO
      PCTKEY(KEY)=CNTKEY(KEY)/GITEMN
      PCTCHO(KEY)=CNTCHO(KEY)/(FITN*GITEMN)
      AVDIFF(KEY) =0.0
      IF (CNTKEY(KEY).EQ.0.0) GO TO 390
      AVDIFF(KEY) =PROSUM(KEY)/CNTKEY(KEY)
 390  CONTINUE
      ITITEM=GITEMN
      IF (MCOPY.LE.1) GO TO 400
      NCOPY=3
C
C  THE FOLLOWING DO LOOP DEALS WITH PRINTING OUT THE STATISTICAL DATA
C  FOR THE ADDITIONAL TEST INFORMATION SECTION OF THE PRINTOUT.
C
C      IN FORTRAN66 IMPLEMENTATION, AUTHOR MUST HAVE ASSUMED THAT NEXT
C      LOOP WOULD BE PERFORMED AT LEAST ONCE.  NEXT STATEMENT WILL ENSUR
C      THAT THAT HAPPENS:     (MOD BY R.SACHER 8/1/85 )
  400  IF (NCOPY.EQ.0) NCOPY=1
      DO 650 JAX=1,NCOPY
      WRITE (IPRINT,410) FMEDI,FMEBIS
  410 FORMAT ('1',50X,'ADDITIONAL TEST INFORMATION'//// 15X,'THE MEAN ',
     1'ITEM DIFFICULTY FOR THE ENTIRE TEST =',F7.3//15X,
     2'THE MEAN ITEM SCORE - TOTAL SCORE BISERIAL CORRELATION =', F6.3)
      WRITE (IPRINT,450) REL,FMEAN,FVAR,SDEV
  450 FORMAT (/15X,
     2 'KUDER-RICHARDSON 20 RELIABILITY =',F7.3//  15X,'TEST MEAN =',
     2 F7.2, '   VARIANCE =', F10.2,  '   STANDARD DEVIATION =',F7.2 /)
      WRITE (IPRINT,480) SEMEAS ,KTN,ITITEM
  480 FORMAT (15X,'STANDARD ERROR OF MEASUREMENT (BASED ON KR-20) =',
     2 F7.2//  15X,
     3 'NUMBER OF STUDENTS =',I5,8X,'NUMBER OF ITEMS ON TEST =',I5//// )
      WRITE (IPRINT,500)
  500 FORMAT (' ',10X,'DISTRIBUTION OF THE TEST ITEMS',39X,'DISTRIBUTION
     1 OF THE TEST ITEMS'/ ' IN TERMS OF THE PERCENTAGE OF STUDENTS',
     2 ' PASSING THEM', 14X,
     3 'IN TERMS OF ITEM SCORE - TOTAL SCORE BISERIAL CORRELATIONS'///
     5 6X,'PERCENT PASSING',11X,'NUMBER OF ITEMS',33X, 'CORRELATIONS',
     6 4X,'NUMBER OF ITEMS'  )
      WRITE (IPRINT,530) IDO,IDVP
  530 FORMAT ('0',10X,'0 - 19',20X,I3,39X,'NEGATIVE - .10',8X,I3)
      WRITE (IPRINT,540) IDTW,IDP
  540 FORMAT (' ',9X,'20 - 39',20X,I3,42X,'.11 - .30',10X,I3)
      WRITE (IPRINT,550) IDTH,IDG
  550 FORMAT (' ',9X,'40 - 59',20X,I3,42X,'.31 - .50',10X,I3)
      WRITE (IPRINT,560) IDFO,IDVG
  560 FORMAT (' ',9X,'60 - 79',20X,I3,42X,'.51 - .70',10X,I3)
      WRITE (IPRINT,570) IDFI,IDVVG
  570 FORMAT (' ',9X,'80 -100',20X,I3,42X,'.71 - .90',10X,I3)
      WRITE (IPRINT,580) IDEX
  580 FORMAT (' ',81X,'.91 -    ',10X,I3/ ////40X,'CHOICES',5X,
     2 '% KEYED',5X,'% CHOSEN',5X,'AVG. DIFF.'  /)
      DO 600 K=1,KCHO
      KK=K+1
  600 WRITE (IPRINT,610) ANS(KK),PCTKEY(K),PCTCHO(K),AVDIFF(K)
  610 FORMAT (43X,A1,9X,F5.3,8X,F5.3,9X,F5.3)
      WRITE (IPRINT,620)
  620 FORMAT (//10X,'% KEYED= FREQUENCY OF A GIVEN KEY DIVIDED BY THE NU
     1MBER OF ITEMS.'/ 10X,'% CHOSEN= FREQUENCY OF A GIVEN RESPONSE DIVI
     2DED BY THE TOTAL NUMBER OF RESPONSES TO ALL ITEMS (EXCLUDING',
     3' OMITS).'/
     3        10X,'AVG. DIFF.= TOTAL OF ALL DIFFICULTY VALUES FOR ITEMS
     1WITH A GIVEN KEY DIVIDED BY THE NUMBER OF SUCH ITEMS.')
  650 CONTINUE
      NEWRUN=1
      RETURN
      END
      SUBROUTINE CONTRL
C  SUBROUTIN  CONTRL    AUTHOR  RICHARD KOHR    VERSION  12 JAN 70
C  SUBROUTINE TO READ AND CONFIRM CONTROL CARDS.
      CHARACTER COURS*10, INST*10, FMT*72
      COMMON BIS(160),T(160),PBIS(160),GITEMN,VAR,SBIS,SDI,FITN,FITEMN,
     1 FMEAN,FVAR,SER,SDEV,TOT(160,10),CMEAN(160,10),PROP(160,10),
     2 CNTKEY(9),PROSUM(9),CNTCHO(9),ITAB(160,10,5),JTOT(160,10)
      COMMON /B2/  IDIST(160,10),
     3               KOUNT(10),IBI(160),IDI(160),KTOT(160),KORAN(160),
     4 IDO,IDTW,IDTH,IDFO,IDFI,IDVP,IDG,IDP,IDVG,IDVVG,IDEX,KTC,KDA,
     5 KDE,KDI,ITN,ITEMN,KODE,ICHO,IDIG,NCOPY,NNXYZ,JCHO,NEWRUN,COURS
     6  ,INST,NOUNT,FMT
      DATA IPRINT/6/,IREAD/5/
 30   FORMAT (I4,2A10,5X,3I2,1X,I4,2X,I3,3(4X,I1), I1,3X,I1 )
   50 FORMAT (80I1)
 51   FORMAT (A72 )
   60 FORMAT (80A1)
 210  FORMAT (' ',33X, 'ITEM ANALYSIS FOR DATA HAVING SPECIFIABLE RIGHT-
     1WRONG ANSWERS' ///// 33X, 'THE USER HAS SPECIFIED THE FOLLOWING IN
     2FORMATION ON CONTROL CARDS' //// 20X,'JOB NUMBER',I6 //20X,
     3 'COURSE  ',A10 //20X,'INSTRUCTOR  ',A10 //20X,'DATE (MONTH, DAY,
     4YEAR)  ',3I4  )
  220 FORMAT (/ 20X, 'NUMBER OF STUDENTS', I6  //20X,'NUMBER OF ITEMS',
     1 I5// 20X,'ITEM EVALUATION OPTION (0=NO, 1=YES)', I4 //20X,
     3 'MAXIMUM NUMBER OF ANSWER CHOICES', I4/)
 241  FORMAT (/25X,'INPUT FORMAT', 3X,A72 / 25X,'RESPONSE FORM  1=A, 2=
     1B, 3=C, ...ETC' )
 242  FORMAT (/25X,'INPUT FORMAT',3X, A72 / 25X,'RESPONSE FORM', I2,
     1 '=A,', I2,'=B, ...'  )
 250  FORMAT (                             /20X,'NUMBER OF COPIES OF OUT
     1PUT (MAX. ALLOWED=2)', I3 //20X,'CORRECT ANSWERS IN GROUPS OF FIVE
     2' /2(25X,15(5I1,1X) /)  )
C
      IF (NEWRUN.EQ.2) GO TO 40
C  READ PARAMETER CARD -- IF KTC=0 END OF RUN ASSUMED.
      READ (IREAD,30) KTC,COURS,INST,KDA,KDE,KDI,ITN,ITEMN,KODE,ICHO,
     1 IDIG,IUNT,NCOPY
      IF (IUNT.NE.0) NOUNT=IUNT
      IF (KTC.EQ.0) CALL EXIT
      IF (IDIG.LE.2) GO TO 40
      WRITE (6,261) IDIG
 261  FORMAT ('0CURRENT VERSION ACCEPTS INPUT OPTION AS 1 OR 2 ONLY...US
     1ER SPECIFIED', I3  )
      CALL EXIT
C
C  READ CORRECT ANSWER CARD, FORMAT CARD.
   40 READ (IREAD,50) (KORAN(I),I=1,ITEMN)
 901  READ (IREAD,51) FMT
      IF (NCOPY.GT.2) NCOPY=2
C  PRINT INFORMATION SUPPLIED ON CONTROL CARDS BY THE USER
      WRITE (IPRINT,210) KTC, COURS, INST,KDA,KDE,KDI
      WRITE (IPRINT,220) ITN, ITEMN,KODE,ICHO
      GO TO (91,92),IDIG
   91 WRITE (IPRINT,241) FMT
      GO TO 100
   92 WRITE (IPRINT,242)  FMT   ,ICHO,ICHO-1
 100  WRITE (IPRINT,250)       NCOPY, (KORAN(I),I=1,ITEMN)
*     Start new page for actual items
      write(IPRINT,'(1H1)')

       IF (IDIG.LT.2) GO TO 903
       IJKLMN=ICHO+1
       DO 902 I=1,ITEMN
902    KORAN(I)=IJKLMN-KORAN(I)
 903   RETURN
      END
